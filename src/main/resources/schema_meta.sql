-- H2 2.2.224; 
;              
CREATE USER IF NOT EXISTS "SA" SALT 'f910b4911e994bb9' HASH 'd09e95077ef0fef96f4a4060d1deb1120c976bdb0e51e9eeb42fecd90ef4f283' ADMIN;          

CREATE MEMORY TABLE "PUBLIC"."USERS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) DEFAULT ON NULL NOT NULL,
    "EMAIL" CHARACTER VARYING(255),
    "FIRST_NAME" CHARACTER VARYING(255),
    "LAST_NAME" CHARACTER VARYING(255)
);
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4D" PRIMARY KEY("ID");
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.USERS;
INSERT INTO "PUBLIC"."USERS" VALUES
(1, 'sandeep.barnwal@outlook.com', 'Sandeep', 'Barnwal');

CREATE MEMORY TABLE "PUBLIC"."TRAIN"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) DEFAULT ON NULL NOT NULL,
    "ARRIVAL_TIME" TIME(6),
    "CODE" CHARACTER VARYING(255),
    "DEPARTURE_TIME" TIME(6),
    "NAME" CHARACTER VARYING(255)
);
ALTER TABLE "PUBLIC"."TRAIN" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4" PRIMARY KEY("ID");
INSERT INTO "PUBLIC"."TRAIN" VALUES
(1, TIME '12:45:00', 'fln-expr', TIME '08:30:00', 'florence-london-express');

CREATE MEMORY TABLE "PUBLIC"."SECTION"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 3) DEFAULT ON NULL NOT NULL,
    "NAME" CHARACTER VARYING(255),
    "TRAIN_ID" BIGINT NOT NULL
);
ALTER TABLE "PUBLIC"."SECTION" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_A" PRIMARY KEY("ID");
INSERT INTO "PUBLIC"."SECTION" VALUES
(1, 'fln-A', 1),
(2, 'fln-B', 1);

CREATE MEMORY TABLE "PUBLIC"."SEAT"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 4) DEFAULT ON NULL NOT NULL,
    "AVAILABLE" BOOLEAN,
    "SEAT_NUMBER" CHARACTER VARYING(255),
    "SECTION_ID" BIGINT NOT NULL
);
ALTER TABLE "PUBLIC"."SEAT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_26" PRIMARY KEY("ID");

INSERT INTO "PUBLIC"."SEAT" VALUES
(1, FALSE, 'A1', 1),
(2, TRUE, 'A2', 1),
(3, TRUE, 'A3', 1);

CREATE MEMORY TABLE "PUBLIC"."BOOKING"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) DEFAULT ON NULL NOT NULL,
    "BOOKING_TIME" TIMESTAMP(6),
    "PRICE_PAID" FLOAT(53) NOT NULL,
    "USER_ID" BIGINT NOT NULL
);
ALTER TABLE "PUBLIC"."BOOKING" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_2" PRIMARY KEY("ID");
INSERT INTO "PUBLIC"."BOOKING" VALUES
(1, TIMESTAMP '2024-07-18 09:58:23.281064', 20.0, 1);


CREATE MEMORY TABLE "PUBLIC"."TICKET"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 2) DEFAULT ON NULL NOT NULL,
    "DEPARTURE_TIME" TIMESTAMP(6),
    "END_STOP" CHARACTER VARYING(255),
    "PASSENGER_FIRST_NAME" CHARACTER VARYING(255),
    "PASSENGER_LAST_NAME" CHARACTER VARYING(255),
    "PNR" CHARACTER VARYING(255),
    "SEAT_NUMBER" CHARACTER VARYING(255),
    "SECTION_NAME" CHARACTER VARYING(255),
    "START_STOP" CHARACTER VARYING(255),
    "TRAIN_CODE" CHARACTER VARYING(255),
    "BOOKING_ID" BIGINT NOT NULL
);
ALTER TABLE "PUBLIC"."TICKET" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_9" PRIMARY KEY("ID");
INSERT INTO "PUBLIC"."TICKET" VALUES
(1, TIMESTAMP '2024-07-17 08:30:00', 'France', 'Sandeep', 'Kumar', '1XWEAOH1', 'A1', 'fln-A', 'London', 'fln-expr', 1);

ALTER TABLE "PUBLIC"."SECTION" ADD CONSTRAINT "PUBLIC"."UK11MDA8TU2B5MBWGS96FVQ7FYS" UNIQUE("TRAIN_ID", "NAME");
ALTER TABLE "PUBLIC"."SEAT" ADD CONSTRAINT "PUBLIC"."UKGXSUHXXJ9F7MM5X4UBE5F0HRU" UNIQUE("SECTION_ID", "SEAT_NUMBER");
ALTER TABLE "PUBLIC"."TRAIN" ADD CONSTRAINT "PUBLIC"."UK21TF3FAB9Q5ELN9EURA9JCLKD" UNIQUE("CODE");
ALTER TABLE "PUBLIC"."SEAT" ADD CONSTRAINT "PUBLIC"."FKHXI4F44GV7S6U5A90EHW1G0X3" FOREIGN KEY("SECTION_ID") REFERENCES "PUBLIC"."SECTION"("ID") NOCHECK;
ALTER TABLE "PUBLIC"."TICKET" ADD CONSTRAINT "PUBLIC"."FKRG7X158T96NUCWSLHQ2BAD6QM" FOREIGN KEY("BOOKING_ID") REFERENCES "PUBLIC"."BOOKING"("ID") NOCHECK;
ALTER TABLE "PUBLIC"."BOOKING" ADD CONSTRAINT "PUBLIC"."FK7UDBEL7Q86K041591KJ6LFMVW" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("ID") NOCHECK;
ALTER TABLE "PUBLIC"."SECTION" ADD CONSTRAINT "PUBLIC"."FKNNQSN0HT898YDG6C2CDWQNXSJ" FOREIGN KEY("TRAIN_ID") REFERENCES "PUBLIC"."TRAIN"("ID") NOCHECK;
